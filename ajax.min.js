(function(){window.AJAX=window.AJAX||{};window.AJAX=function(a){this.globalError=function(a){alert(404===a?"404 Not Found":"Oh dear.  Something is very wrong")};this.globalLogin=function(){};a.hasOwnProperty("method")&&"POST"===a.method?this.postRequest(a):this.getRequest(a)};AJAX.prototype.postRequest=function(a){var b="application/x-www-form-urlencoded",c=a.data;a.hasOwnProperty("contentType")&&(b=a.contentType,-1!==b.indexOf("application/json")&&(c=JSON.stringify(a.data)));this.xmlhttp=this.getxmlhttpObj();
this.xmlhttp.open("POST",a.url,!0);this.xmlhttp.setRequestHeader("Content-type",b);var b=this.xmlhttp,d=this.checkResponse(a);b.onreadystatechange=function(){d};this.xmlhttp.send(c)};AJAX.prototype.getRequest=function(a){this.xmlhttp=this.getxmlhttpObj();this.xmlhttp.open("GET",a.url,!0);var b=this.xmlhttp,c=this.checkResponse(a);b.onreadystatechange=function(){c};this.xmlhttp.send(null)};AJAX.prototype.checkResponse=function(a){var b=this;4!==this.xmlhttp.readyState?setTimeout(function(){b.checkResponse(a)},
20):this.getResponse(a)};AJAX.prototype.getResponse=function(a){switch(this.xmlhttp.status){case 200:case 204:return a.onSuccess(JSON.parse(this.xmlhttp.responseText));case 401:this.globalLogin();break;case 400:case 403:case 404:case 500:this.globalError(this.xmlhttp.status);break;default:this.globalError()}};AJAX.prototype.getxmlhttpObj=function(){return window.XMLHttpRequest?new XMLHttpRequest:window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null}})();
